# 樂透賓果遊戲系統

一個多人即時賓果樂透遊戲系統，無需資料庫，使用 localStorage 和輪詢機制實現即時同步。

## 功能特色

- 🎮 **開啟新遊戲**：快速建立遊戲房間
- 📱 **QR Code 掃描**：玩家掃描即可加入
- 🎫 **自動生成樂透券**：5×5 隨機數字矩陣（1-99）
- 🎲 **即時抽獎**：主持人抽取數字，玩家同步更新
- 🎉 **賓果偵測**：自動檢測直線、橫線、斜線賓果
- ✨ **賓果特效**：完成賓果時顯示動畫效果

## 檔案結構

```
lottery/
├── index.html          # 主頁面（建立遊戲）
├── room.html           # 遊戲房間（主持人介面）
├── ticket.html         # 樂透券（玩家介面）
├── css/
│   └── lottery.css     # 統一樣式表
└── js/
    ├── lottery.js      # 主頁面邏輯
    ├── room.js         # 房間管理邏輯
    └── ticket.js       # 樂透券邏輯
```

## 使用說明

### 方式一：本地版本（同裝置測試）

適合在同一台電腦上開啟多個分頁測試。

### 方式二：伺服器版本（真正跨裝置）

如需跨裝置使用，請使用後端伺服器：

```bash
# 1. 安裝依賴
cd lottery
npm install

# 2. 啟動伺服器
npm start

# 3. 開啟瀏覽器訪問
# http://localhost:3000
```

注意：使用伺服器版本需要修改前端 JavaScript 檔案，將 localStorage 操作改為 Socket.IO 通訊。

---

### 1. 開始遊戲（主持人）

1. 開啟 `index.html`
2. 點擊「開啟新遊戲」按鈕
3. 系統會生成唯一的房間 ID 並跳轉到遊戲房間

### 2. 邀請玩家

在遊戲房間頁面：
- 展示 QR Code 供玩家掃描
- 或複製連結分享給玩家

### 3. 玩家加入

玩家掃描 QR Code 或開啟連結後：
1. 輸入暱稱
2. 系統自動生成專屬樂透券（5×5 隨機數字）
3. 中間格子為「FREE」萬用格

### 4. 開始抽獎

主持人在房間頁面：
1. 點擊「🎲 抽取數字」隨機抽出 1-99 的數字
2. 已抽出的數字會顯示在畫面上
3. 玩家的樂透券會自動標記被抽中的數字

### 5. 賓果判定

當玩家達成賓果條件時：
- 玩家畫面會顯示「🎉 BINGO!」特效
- 主持人畫面會在玩家名稱旁顯示賓果徽章
- 可以完成多條線（最多 12 條）

賓果條件：
- 橫向連續 5 個
- 縱向連續 5 個
- 對角線連續 5 個

### 6. 重新開始

主持人可以點擊「🔄 重新開始」清除所有已抽出的數字，保留玩家名單。

## 技術實作

### 資料儲存

使用瀏覽器的 localStorage 儲存：
- 房間資料（ID、玩家列表、已抽出數字）
- 每個房間的 key 為 `lottery_room_{roomId}`

### 即時同步

採用輪詢機制：
- 每秒檢查 localStorage 的變化
- 主持人介面：同步玩家列表
- 玩家介面：同步已抽出的數字

### 數字生成

- 使用 Fisher-Yates 洗牌演算法保證隨機性
- 從 1-99 選取 24 個不重複數字
- 中間格（索引 12）固定為萬用格

### 賓果演算法

檢查所有可能的連線：
- 5 條橫向線
- 5 條縱向線
- 2 條對角線
- 總計最多 12 條線

## 瀏覽器相容性

- 需要支援 localStorage 的現代瀏覽器
- 建議使用 Chrome、Firefox、Safari、Edge 最新版本
- QR Code 生成使用 qrcodejs 函式庫

## 限制與說明

### 跨裝置使用限制

**重要提醒**：由於本系統使用瀏覽器的 localStorage 儲存資料，跨裝置使用時有以下限制：

#### ⚠️ 目前版本的運作方式

1. **同裝置多分頁**：可以正常運作
   - 例如：在電腦上開啟多個瀏覽器分頁測試
   
2. **跨裝置使用**：需要手動同步
   - 當手機掃描 QR Code 時，會自動建立該房間的本地副本
   - 但**已抽出的數字不會即時同步**到其他裝置
   - 需要主持人和玩家在同一台裝置上操作，或使用下方的後端伺服器方案

#### 📱 測試建議

**單裝置測試**：
- 在電腦上開啟主持人頁面（room.html）
- 在同一台電腦開啟多個新分頁，複製 QR Code 下方的連結
- 每個分頁模擬不同玩家

**跨裝置測試**：
- 目前版本僅支援有限的跨裝置功能
- 建議使用下方的進階功能建議實作真正的多人線上版本

## 進階功能建議

如需真正的多人線上遊戲（跨裝置即時同步），建議：

### 方案一：使用後端伺服器（推薦）

1. **後端技術**：Node.js + Express + Socket.IO
2. **即時通訊**：WebSocket 實現即時同步
3. **資料儲存**：Redis（快取）+ MongoDB/PostgreSQL（持久化）

### 方案二：使用雲端服務

1. **Firebase Realtime Database**：Google 提供的即時資料庫
2. **Supabase**：開源的 Firebase 替代方案
3. **PocketBase**：輕量級後端解決方案

### 方案三：P2P 連線

使用 WebRTC Data Channel 實現點對點連線，無需伺服器

## 授權

本專案僅供學習和娛樂使用。
